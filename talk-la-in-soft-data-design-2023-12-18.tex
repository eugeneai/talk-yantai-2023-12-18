\documentclass[10pt]{beamer}
\usepackage{amsmath,amssymb,longtable,hhline}
\usepackage{mathrsfs}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{multicol}
\usepackage{anyfontsize}
\usepackage{minted}
\usepackage{alltt}
\usepackage{tabularray}

%\usepackage{pgfpages}
%\mode<handout>{\setbeamercolor{background canvas}{bg=white}}
%\pgfpagesuselayout{2 on 1}[letterpaper,border shrink=2mm]

\usemintedstyle{tango}
\newcommand{\ltprgsize}{\fontsize{5}{5}\selectfont}
%\newcommand{\ltprgsize}{\footnotesize}
\setminted{fontsize=\footnotesize{},mathescape}

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\hypersetup{
    bookmarks=true,         % show bookmarks bar?
    unicode=true,           % non-Latin characters in Acrobat’s bookmarks
    pdftoolbar=false,       % show Acrobat’s toolbar?
    pdfmenubar=false,       % show Acrobat’s menu?
    pdffitwindow=false,     % window fit to page when opened
    pdfstartview={FitH},    % fits the width of the page to the window
    pdftitle={Model Driven Architecture Implementation using Linked Data},    % title
    pdfauthor={Evgeny Cherkashin, Alexey Kopaygorodsky, Ljubica Kazi, Alexey Shigarov, Viacheslav Paramonov},     % author
    pdfsubject={model driven architecture},   % subject of the document
    pdfnewwindow=true,      % links in new PDF window
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=red,          % color of internal links (change box color with linkbordercolor)
    citecolor=green,        % color of links to bibliography
    filecolor=magenta,      % color of file links
    urlcolor=blue           % color of external links
}

\usepackage{pifont}

\usetheme{Warsaw}
\usecolortheme{crane}
%\useinnertheme{rectangles}
%\setbeamertemplate{itemize item}{\scriptsize\hbox{\donotcoloroutermaths\ding{113}}}
\definecolor{darkding}{RGB}{200,56,0}
\setbeamertemplate{itemize item}{\scriptsize\hbox{\color{darkding}{\bfseries\ding{113}}}}
\setbeamertemplate{itemize subitem}{\tiny\raise1.5pt\hbox{\donotcoloroutermaths$\blacktriangleright$}}
\setbeamertemplate{itemize subsubitem}{\tiny\raise1.5pt\hbox{\donotcoloroutermaths$\blacktriangleright$}}
\setbeamertemplate{enumerate item}{\insertenumlabel.}
\setbeamertemplate{enumerate subitem}{\insertenumlabel.\insertsubenumlabel}
\setbeamertemplate{enumerate subsubitem}{\insertenumlabel.\insertsubenumlabel.\insertsubsubenumlabel}
\setbeamertemplate{enumerate mini template}{\insertenumlabel}

\beamertemplatenavigationsymbolsempty

\usepackage{iftex,ifxetex}
\ifPDFTeX
  \usepackage[utf8]{inputenc}
  \usepackage[T1]{fontenc}
  \usepackage[russian]{babel}
  \usepackage{lmodern}
  \usefonttheme{serif}
\else
  \ifluatex
    \usepackage{unicode-math}
    \defaultfontfeatures{Ligatures=TeX,Numbers=OldStyle}
    \setmathfont{Latin Modern Math}
%    \setsansfont{Linux Biolinum O}
    \setsansfont{Source Han Sans CN Medium}
    \setmonofont{Source Han Sans CN Medium}
    % \setmonofont{Fira Mono}[Scale=MatchLowercase]
    \usefonttheme{professionalfonts}
    % \setmathfont[
    %     Ligatures=TeX,
    %     Scale=MatchLowercase,
    %     math-style=upright,
    %     vargreek-shape=unicode
    %     ]{euler.otf}
  \fi
\fi

%\useoutertheme{split}
%\useinnertheme{rounded}
\setbeamertemplate{background canvas}[vertical shading][bottom=white!80!cyan!20,top=cyan!10]
%\setbeamertemplate{sidebar canvas left}[horizontal shading][left=white!40!black,right=black]

\graphicspath{{pics/}}

\providecommand{\email}[1]{\texttt{#1}}
\usepackage{changepage}
\newcommand{\GB}[1]{\colorbox{green}{#1}}
\newcommand{\BB}[1]{\colorbox{blue}{#1}}
\newcommand{\RB}[1]{\colorbox{red}{#1}}
\newcommand{\btprgsize}{\fontsize{7}{7}\selectfont}

% --------------------------

\begin{document}

\setbeamertemplate{background canvas}[vertical shading][bottom=white,top=white]
\setbeamercolor{background canvas}{bg=white}

\title{Logical Approach in Software and Data Design\\软件和数据设计中的逻辑方法}
\author[E.~Cherkashin, et al.]{\bfseries%
  Evgeny Cherkashin}
\institute{\normalsize Matrosov Institute for System Dynamics and Control Theory of Siberian Branch of Russian Academy of Sciences, Irkutsk, Russia\\
俄罗斯伊尔库茨克，Matrosov 俄罗斯科学院西伯利亚分院系统动力学与控制理论研究所

  %
  \email{\href{mailto:eugeneai@icc.ru}{eugeneai@icc.ru}}%
}
\date[2023]{2023, December,\\
Yantai, China
}
%\date{\today}
\maketitle

\begin{frame}
  \frametitle{QR-Code of the presentation}
  \begin{center}
    \includegraphics[width=0.4\linewidth]{presentation.png}
\url{https://github.com/eugeneai/talk-yantai-2023-12-18/blob/master/talk-la-in-soft-data-design-2023-12-18.pdf}

  \end{center}
\end{frame}

\begin{frame}
  \frametitle{Model--Driven Architecture: Research objectives}
  \textbf{Main objective} of the research is to construct a MDA technology based on nowadays system modeling visual languages (SysML, UML, BPMN, CMMN) and existing Semantic Web \textbf{vocabularies} and \textbf{technologies}. The following techniques and software are under development:
  \begin{enumerate}
  \item CIM representation with SysML, BPMN, CMMN, and results of source code processing,
  \item CIM, PIM, PSM representation in UML, RDF with existing vocabularies,
  \item transformation implementation with logical language Logtalk,
  \item usage of LOD sources in transformations for obtaining additional semantic data,
  \item generation of documents and user interfaces with LOD markup.
  \end{enumerate}
\end{frame}

\begin{frame}
  \frametitle{模型驱动架构： 研究目标}
  \textbf{研究的主要目标是基于当今的系统建模可视化语言\\（SysML、UML、BPMN、CMMN）和现有的语义网词汇表和技术\\ 构建一种 MDA 技术 以下技术和软件正在开发中}
  \begin{enumerate}
  \item 用 SysML、BPMN、CMMN 和源代码处理结果表示 CIM、
  \item  用 UML、RDF 和现有词汇表表示 CIM、PIM 和 PSM、
  \item 使用逻辑语言 Logtalk 实现转换、
  \item  在转换中使用 LOD 源以获取额外的语义数据、
  \item  使用 LOD 标记生成文档和用户界面。
  \end{enumerate}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Model--Driven Architecture}

  \begin{columns}
    \begin{column}{0.4\textwidth}
      \includegraphics[width=1\linewidth]{mda-most-general.pdf}
    \end{column}
    \begin{column}{0.7\linewidth}
      \begin{description}
      \item[MDA] Model--Driven Architecture;
      \item[CIM] Computationally Independent Model;
      \item[CM] Model of Computations;
      \item[PIM] Platform Independent Model;
      \item[PM] Platform Model;
      \item[PSM] Platform--Specific Model;
      \item[CODE] Source code of software;
      \item[DATA] Initial database state.
      \end{description}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{模型驱动架构（Model--Driven Architecture）}
  \begin{columns}
    \begin{column}{0.4\textwidth}
      \includegraphics[width=1\linewidth]{mda-most-general.pdf}
    \end{column}
    \begin{column}{0.7\linewidth}
      \begin{description}
      \item[MDA] 模型驱动架构（Model--Driven Architecture）；
      \item[CIM] Computationally Independent Model（独立计算模型）；
      \item[CM] 计算模型；
      \item[PIM] 平台独立模型；
      \item[PM] 平台模型；
      \item[PSM] 特定平台模型；
      \item[CODE] 软件源代码；
      \item[DATA] 初始数据库状态。
      \end{description}
    \end{column}
  \end{columns}
\end{frame}

% \begin{frame}
%   \frametitle{Related technologies and standards}
%   \begin{itemize}
%   \item The most widely used technologies \textbf{ATL} and its predecessor QVT, an OMG standard; developed for XMI to XMI conversion;
%   \item Usage of ATL trending to shift to CIM level, \emph{e.g.}, BPMN diagram is converted into set of UML diagrams (PIM); used for construction web-applications, CIM is represented with State and Use case UML-Diagrams.
%   \item MDA usage is widening, \emph{e.g.}, for analysis of security aspects of distributed application with logical inference over MDA represented model;
%   \item UML is used as CIM/PIM in modeling vocabularies (ontologies); there is an OMG standard specification;
%   \item XML specifications are used to describe services, \emph{e.g.} WSDL, WS-BPEL;
%   \item MDA is opposed to conceptual programming by Enn Tyugu.
%   \end{itemize}

%   We describe transformation in Logtalk, representing CIM, PIM and PSM as RDF graphs, allowing non-XMI sources to be used, organizing multi-stage modular transformations.
% \end{frame}

\begin{frame}
  \frametitle{Logtalk as transformation definition language}
  We have chosen Logtalk as it
  \begin{itemize}
  \item inherits widely known Prolog language syntax and runtime;
  \item is implemented as macro package, performance penalties are about 1.5\%;
  \item has flexible semantics: we can define transformations and constraints within the same syntax;
  \item implement object--oriented knowledge (rules) structuring, encapsulation and replacement;
  \item compositional way of transformation implementation;
  \item powerful engine to post constraints on object-to-object messages (events);
  \item has implementation for various Prolog engines.
  \end{itemize}
  The <<regular>> language allow us to use its libraries not directly related to MDA transformations.
\end{frame}

\begin{frame}
  \frametitle{Logtalk 作为转换定义语言}
  我们选择Logtalk是因为它
  \begin{itemize}
  \item 继承了广为人知的 Prolog 语言的语法和运行时；
  \item 作为宏包实现，性能损失约为1.5%；
  \item 具有灵活的语义：我们可以在相同的语法中定义转换和约束；
  \item 实现了面向对象的知识（规则）结构化、封装和替换；
  \item 实现转换的组合方式；
  \item Logtalk是一个强大的引擎，可以对对象到对象的消息 \\
    （事件）发布约束；
  \item 为各种Prolog引擎提供实现。
  \end{itemize}
这种常规语言允许我们使用它与 MDA 转换没有直接关系的库。
\end{frame}

% \begin{frame}[fragile]
%   \frametitle{Semantic Web technologies in representation of models
%     during transformation}
%   \begin{itemize}
%   \item Assimilates experience of domain basic researches trending to standardization;
%   \item Regular set of triples denote a graph (T-Box, A-Box);
%   \item Standard vocabularies are formally described (\verb|rdfs:domain|, \verb|rdfs:range|);
%   \item Supported with most programming systems (libraries, inference engines, SPARQL);
%   \item RDF has a way of global element identification, \emph{i.e.} we can refer the same object from different software systems;
%   \item SWI-Prolog supports direct queries to a graph, as well as interpreting some predicates (\verb|rdfs:label|, \verb|dc:title|), wraps sparse RDF structure into a predicate arguments; ontological server ClioPatria;
%   \item There is simple way of data security implementation (\verb|rdfs:seeAlso|);
%   \item By means of Semantic Web \& LOD we are able to organize data transfer between heterogeneous information systems.
%   \end{itemize}
% \end{frame}

\begin{frame}
  \frametitle{Linked Open Data, LOD}
  \begin{enumerate}
  \item Information is published in Internet with open access license;
  \item It is represented in a machine-readable form, e.g., Excel table instead of a bitmap picture;
  \item An open format used, e.g., CSV instead of Excel;
  \item The format is based on W3C recommended standards, allowing RDF and SPARQL reference;
  \item Published data refer to objects, forming context.
  \end{enumerate}
  Thus, applications publish data as relations of objects (entities).
\end{frame}

\begin{frame}
  \frametitle{Linked Open Data, 关联开放数据, LOD}
  \begin{enumerate}
  \item 信息在互联网上发布，采用开放式获取许可；
  \item 它以机器可读的形式表示，例如 Excel 表格，而不是位图图片；
  \item 使用的开放格式，如 CSV 而非 Excel；
  \item 该格式基于 W3C 推荐的标准，允许引用 RDF 和 SPARQL；
  \item 发布的数据指代对象，形成上下文。
  \end{enumerate}
  因此，应用程序以对象（实体）关系的形式发布数据。
\end{frame}

\begin{frame}
  \frametitle{Model Driven Architecture and Linked Open Data}
  模型驱动架构和关联开放数据
  \begin{center}
    \includegraphics[width=0.9\linewidth]{mda-overview.pdf}
  \end{center}
\end{frame}

\begin{frame}
  \frametitle{MDA infrastructure,  基础设施}
  \centering
  \includegraphics[width=1\linewidth]{architecture-mda-lod-ext.pdf}
\end{frame}

\begin{frame}
  \frametitle{Architecture of transformation modules, 转换模块的结构}
  \centering
  \includegraphics[width=0.9\linewidth]{architect_tree_pres-en-wo-OCL.pdf}
\end{frame}

\begin{frame}[fragile]
  \frametitle{PSM: Scenario of a Class synthesis, PSM: 课堂综合情景}

%\begin{multicols}{2}
  \begin{columns}
    \begin{column}{0.6\textwidth}
\begin{minted}[fontsize=\tiny]{logtalk}
:- object(direct(_Package,_LocalProf,_CodeProf)).    % 转换驱动程序对象
:- public([tr/4,tr/3]).                              % 类综合方案的公共接口
% . . . . . . . . . .
tr(class, Class, ClassID):- ::package(Package),      % 合成一个类
    query(Package)::class(Name, ClassID),            % XMI 中的查询包结构
    create_object(Class,      % . . . . .            % 创建类对象
    create_object(Attributes, % . . . . .            % 创建属性对象
    create_object(Methods,    % . . . . .            % ...方法
    Class::name(Name),                               % 为班级命名。
    % Generate attributes of the class,
    % organizing them in a local database.
    % ...methods...
    Class::attributes(Attributes),                   % 为类设置属性。
    Class::methods(Methods).                         % ...方法。

tr(attribute, Attribute, ClassID, AttributeID):-     % 属性转换
    ::package(Package),
    query(Package)::attribute(Name,ClassID,AttrID),
    create_object(Attribute,  % . . . . .
    Attribute::name(Name).                           % 为属性命名。

tr(method, Method, ClassID, MethodID):-              % 方法的转变
    ::package(Package),
    query(Package)::method(Name,ClassID,MethodID),
    create_object(Method,     % . . . . .
    Method::name(Name).                              % 方法名称
:- end_object.
\end{minted}
    \end{column}
    \begin{column}{0.4\linewidth}
      \includegraphics[width=1\linewidth]{scenario.pdf}
    \end{column}
  \end{columns}
  % \end{multicols}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Implementation of \texttt{Query} object, 实现查询对象}
\begin{minted}[fontsize=\footnotesize{}]{logtalk}
:- object(query(_XMI)).
:- protected(xmi/1).
:- public([class/2, attribute/3, method/3]).
xmi(XMI) :- parameter(1, XMI).
class(Name, ID):-                            % 识别 RDF 中的类别
    ::xmi(XMI),
    XMI::rdf(ID,rdf:type,uml:'Class'),
    XMI::rdf(ID,rdfs:label, literal(Name)).
attribute(Name, ClassID, ID):-               % ...属性...
    ::xmi(XMI),
    XMI::rdf(ClassID, xmi:ownedAttribute, ID),
    XMI::rdf(ID, rdfs:label, literal(Name)).
method(Name, ClassID, ID):-                  % ...方法...
    ::xmi(XMI),
    XMI::rdf(ClassID, xmi:ownedOperation, ID),
    XMI::rdf(ID, rdfs:label, literal(Name)).
% . . . . . . . . . . .
:- end_object.
\end{minted}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Code Block (idea is taken from \texttt{llvmlite}${}^*$, 代码块，创意来自 "llvmlite "图书馆)}
  \begin{columns}
    \begin{column}{0.6\textwidth}
      \flushleft
\begin{minted}[fontsize=\footnotesize{}]{logtalk}
:- object(code_block, specializes(root)).
% Public interface of the object
:- public([append/1, prepend/1, clear/0,
   render/1, render_to/1, remove/1,
   item/1, items/1]).
% Code block items
:- dynamic([item_/1]).
:- private([item_/1]).
% Methods specialized during inheritance
:- protected([renderitem/2, render_to/2]).
% . . . . . . . . . . . .
% Delegate rendering to object itself
renderitem(Object, String):-
    current_object(Object), !,
    Object::render(String).
% Convert a literal to its string
% representation
renderitem(literal(Item), String):-!,
    atom_string(Item, String).
% Just print the item (debugging).
renderitem(Item, String):-
    root::iswritef(String, '%q', [Item]).
:- end_object.
\end{minted}
    \end{column}
    \begin{column}{0.4\textwidth}
      \includegraphics[width=1\linewidth]{code_block.pdf}
  ${}^*$) \url{https://github.com/numba/llvmlite}
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{PSM of a Python Class as a specialization of Code Block, 作为代码块特化的 Python 类}
%\begin{multicols}{2}
  \begin{columns}
    \begin{column}{0.6\textwidth}
      \flushleft
\begin{minted}[fontsize=\scriptsize]{logtalk}
:- object(class, specializes(code_block),
   imports([named])). % Category of named entities
:- public([classlist/1, methods/1, attributes/1]).
% . . . . . . . . . . . . . .
renderitem(Item, Result):-      % proceed with default
    ^^renderitem(Item, Result). % rendering
render(Result):-         % Source generator
    ^^render(Name),      % implemented in a category
    ( ::item(classlist(List)) ->
     % . . . . . . . . . . .
        [Name]) ),
    ( ::item(attributes(Attributes))->
     % . . . . . . . . . . .
        [DefAttrList]),
      Attributes::items(InstanceAttrs),
      findall(S, ( % initialize attributes
         % . . . . . . . . .
         ), AttrAssigns),
        root::unindent,
        AttrList=[ConstructorDef|AttrAssigns];
         % . . . . . . . . .
        AttrList=[ConstructorDef, Pass] ),
    ( ::item(methods(Methods))-> % If any ...
      Methods::render(MethodList);
      MethodList=[] ),
    lists::append(AttrList,MethodList,StringList),
    root::unindent, Result=[Signature|StringList].
:- end_object.
\end{minted}
    \end{column}
    \begin{column}{0.4\linewidth}
      \includegraphics[width=1\linewidth]{code_block_class.pdf}
    \end{column}
  \end{columns}
  % \end{multicols}
\end{frame}

% \begin{frame}[fragile]
%   \frametitle{Logtalk Categories}
%   A category of named entities
% \begin{minted}[fontsize=\scriptsize]{logtalk}
% :- category(named).
% :- public([name/1, render/1]).
% :- protected([renderitem/2]).
% name(Name):- ::prepend(name(Name)).
% renderitem(name(Name), String):-!, atom_string(Name, String).
% render(String):-  % What is code generation from items
%     ::item(name(Name)), ::renderitem(name(Name), String).
% :-end_category.
% \end{minted}
% Category of named and typed entities
% \begin{minted}[fontsize=\scriptsize]{logtalk}
% :- category(namedtyped, extends(named)).
% :- public([type/1,render/2, separator_option/2,list_separator/1]).
% :- protected([renderitem/2]).
% type(Type):- ::append(type(Type)).
% renderitem(Item, String):- ^^renderitem(Item, String),!.
% renderitem(type(Type),String):-!, ::list_separator(Separator),
%     writef::swritef(String, '%w%w', [Separator, Type]).
% render(Middle, String):- ^^render(SName),
%     (   ::item(type(Type)) ->
%         ::renderitem(type(Type), SType),
%         string_concat(SName, Middle, _1),
%         string_concat(_1, SType, String) ;
%         SName = String  ).
% render(String):-  ::render("", String).
% list_separator(Separator):-
%     ::separator_option(Name, Default),!, % Global options
%     root::option(Name, Separator, Default).
% :- end_category.

% \end{minted}
% \end{frame}

% \begin{frame}[fragile]
%   \frametitle{Access LOD data}

%   \begin{columns}
% \begin{column}{0.5\textwidth}
% \begin{minted}[fontsize=\scriptsize]{logtalk}
% :- category(sparql).
% :- public(query/2).
% query(Pattern,Parameters,Row):-
%     prepare(Pattern,Parameters,Query),
%     server(Host,Port,Path),
%     sparql_query(Query, Row,
%         [host(Host),port(Port),path(Path)]).
% :- protected(server/3).  % must be implemented
%                          % by a subclass.
% :- protected(prepare/3). % prepares a query
% % . . . . . . . . . .    %             string.
% :- end_category.

% :- object(dbpedia, extends(sparql)).
% :- protected(server/3).
% server('dbpedia.org',80,'/sparql').
% :- public(entity_name/2).
% entity_name(Entity,Language,Name):-
%     query('select ?name where { '
%           ' %w rdfs:label ?name. '
%           'FILTER langMatches( lang(?label),'
%           ' "%w" )}', [Entity, Language],
%           row(Name)).
% :- end_object.

% % ?- dbpedia::entity_name(dbr:'Passport', 'ru', Name).
% \end{minted}
% \end{column}
% \begin{column}{0.5\textwidth}
%   \flushright
% \includegraphics[width=0.8\linewidth]{simple-diag.pdf}
% \end{column}
% \end{columns}
% \end{frame}


\begin{frame}
  \frametitle{Applications: Dataflow representation of NGS analysis of amplicons, 应用： 扩增子 NGS 分析的数据流表示法}
  \begin{columns}
    \begin{column}{0.6\textwidth}
      \begin{raggedright}
        \includegraphics[width=1\linewidth]{Dataflow-color-en.png}
      \end{raggedright}
    \end{column}
    \begin{column}{0.4\textwidth}\footnotesize
      \begin{tabular}{ll}
        Term 术语 & Description 说明 \\
        \hline
        NGS & 新一代测序 \\
        Amplicon & 复制多次的 DNA \\ & 或 RNA 部分 \\
        Mothur & 用于 NGS \\ & 研究的软件工具集 \\
        Rapidminer & 视觉分析工具 \\
      \end{tabular}
      ${}$\\[1em]
      Green blocks are Mothur modules. Others are Rapidminer modules.\\ 绿色块为 Mothur 模块。其他为 Rapidminer 模块。
    \end{column}
  \end{columns}
\end{frame}


% \begin{frame}
%   \frametitle{Application in developing KBS}
%   Development and maintaining applied \textbf{knowledge--based systems (KBS)} in the up to date adequate state requires a lot of efforts devoted to solving problems of
%   \begin{itemize}
%   \item data model evolution,
%   \item functionality expansion,
%   \item graphical user interface modification.
% \end{itemize}

% To address these problems and, therefore, reduce the cost of creating, modifying and upgrading of applied KBS an automation of KBS development process is required.
% \end{frame}

% \begin{frame}
%   \frametitle{Application in developing KBS}
%   \begin{center}
%   \includegraphics[width=0.9\linewidth]{kbs-stolboff.pdf}
% \end{center}
% \end{frame}

\begin{frame}[fragile]
  \frametitle{Rapidminer module synthesis, 模块合成}
\begin{minted}[fontsize=\tiny]{cpp}
vector<string> AlignCommand::setParameters(){ // 模块源的一部分
try {
  CommandParameter ptemplate("reference", "InputTypes", "", "", "none", "none", "none","",false,true,true); parameters.push_back(ptemplate);
  CommandParameter pcandidate("fasta", "InputTypes", "", "", "none", "none", "none","fasta-alignreport-accnos",false,true,true); parameters.push_back(pcandidate);
  CommandParameter psearch("search", "Multiple", "kmer-blast-suffix", "kmer", "", "", "","",false,false,true); parameters.push_back(psearch);
  CommandParameter pksize("ksize", "Number", "", "8", "", "", "","",false,false); parameters.push_back(pksize);
  CommandParameter pmatch("match", "Number", "", "1.0", "", "", "","",false,false); parameters.push_back(pmatch);
// . . . . . . .
\end{minted}
\begin{minted}[fontsize=\tiny]{java}
package com.rapidminer.ngs.operator; // 生成的 Java 模块
// imports

class MothurChimeraCcodeOperator extends MothurGeneratedOperator {
  private InputPort fastaInPort = getInputPorts().createPort("fasta");
  private InputPort referenceInPort = getInputPorts().createPort("reference");
  private OutputPort chimeraOutPort = getOutputPorts().createPort("chimera");
  private OutputPort mapinfoOutPort = getOutputPorts().createPort("mapinfo");
  private OutputPort accnosOutPort = getOutputPorts().createPort("accnos");

  public MothurChimeraCcodeOperator (OperatorDescription description) {
    super(description);
  }
  @Override
  public void doWork() throws OperatorException {
    super();
    // . . . . . .
  }
  @Override
  public List<ParameterType> getParameterTypes() {
    super();
        // . . . . . .
  }
  @Override
  public String getOutputPattern(String type) {
    if (type=="chimera") return "[filename],[tag],ccode.chimeras-[filename],ccode.chimeras";
    if (type=="mapinfo") return "[filename],mapinfo";
    if (type=="accnos") return "[filename],[tag],ccode.accnos-[filename],ccode.accnos";
    return super.getOutputPattern(type);
  }
}
\end{minted}
\end{frame}

\begin{frame}[fragile]
  \frametitle{RDF (TTL) representation and ad its query object, RDF 表示法并添加其查询对象}
\begin{multicols}{2}
\begin{minted}[fontsize=\tiny]{turtle}
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
ngsp:spec a ngsp:Specification ;
    ngsp:module mothur:NoCommand,
        mothur:align-check,
        mothur:align-seqs,
# . . . . .
mothur:align-check a ngsp:Module ;
    ngsp:outputPattern [ a cnt:Chars ;
            ngsp:parameterName "type" ;
            ngsp:pattern [ ngsp:patternString
                    "[filename],align.check" ;
                    dc:identifier "aligncheck" ] ;
            cnt:chars # . . . .
# . . . . .
mothur:align-check-idir-parameter a ngsp:Parameter ;
    ngsp:important false ;
    ngsp:multipleSelectionAllowed false ;
    ngsp:optionsDefault "" ;
    ngsp:required false ;
    ngsp:type mothur:String ;
    dc:title "inputdir" .

mothur:align-check-map-parameter a ngsp:Parameter ;
    ngsp:important true ;
    ngsp:multipleSelectionAllowed false ;
    ngsp:optionsDefault "" ;
    ngsp:required true ;
    ngsp:type mothur:InputTypes ;
    dc:title "map" .

mothur:align-check-name-parameter a ngsp:Parameter ;
    ngsp:chooseOnlyOneGroup "namecount" ;
    ngsp:important false ;
    ngsp:multipleSelectionAllowed false ;
# . . . . .
\end{minted}
\begin{minted}[fontsize=\tiny]{logtalk}
:- object(queryparam(_RDF,_Parameter),
          extends(ngsquerybase)).

:- public(type/1).  % 立面对象
type(Type) :-
    ::attr(type, Type).
:- public(name/1).
name(Name) :- ::attr(dc:title, literal(Name)).
:- public(options/1).
options(Value):- ::attr(options, Value).
:- public(options_default/1).
options_default(Value):-
    ::attr(optionsDefault, Value).
% . . . . . . . .
:- public(multiple_selection_allowed/0).
multiple_selection_allowed:-
    ::bool_attr(multipleSelectionAllowed).
:- public(required/0).
required:-
    ::bool_attr(required).
:- public(important/0).
important:-
    ::bool_attr(important).
:- protected(attr/2).
attr(NS:Name, Value):-
    ::ngs(RDF),
    ::second(Parameter),
    rdf_db::rdf_global_object(Value, V),
    RDF::rdf(Parameter, NS:Name, V).
attr(Name, Value):-
    \+ Name=_:_,!,
    ::ngs(RDF),
    ::second(Parameter),
    rdf_db::rdf_global_id(Value, V),
    RDF::rdf(Parameter, ngsp:Name, V).
% . . . . .
:- end_object.

\end{minted}
\end{multicols}
\end{frame}

\begin{frame}
  \frametitle{Discussion}
  Interesting positive impressions obtained:
  \begin{itemize}
  \item Logtalk and RDF are flexible, sufficiently universal and convenient implementation infrastructures for MDA;
  \item The best implemenation means is Prolog predicate wrapping and Logtalk object encapsulation of rules;
  \item Not all Logtalk properties are investigated: there might be more sophisticated programming techniques developed, \emph{e.g.}, on the base of message watchers.
  \end{itemize}
  Technical problems making the approach somewhat problematic:
  \begin{itemize}
  \item Very simple tasks take too much efforts, \emph{e.g.}, text processing: convert an identifier into the CamelCase;
  \item It takes too long to surf Internet in order to find a vocabulary for a domain, but it is more productive than development;
  \item Prolog is not a popular language in MDA, neither Logtalk.
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Discussion, 讨论}
  有趣的正面印象:
  \begin{itemize}
  \item Logtalk 和 RDF 是灵活、足够通用和方便的 MDA 实现基础架构；
  \item 最好的实现手段是对规则进行Prolog谓词封装和Logtalk对象封装；
  \item 并非所有的Logtalk属性都得到了研究：在消息监视器的基础上，\\ 可能会开发出更复杂的编程技术。
  \end{itemize}
  技术问题使得这种方法有些困难：
  \begin{itemize}
  \item 非常简单的任务就需要花费太多精力，比如文本处理：\\将标识符转换成 CamelCase；
  \item 为了找到一个领域的词汇而上网太花时间了，\\但这比开发更有成效；
  \item Prolog在MDA中并不流行，Logtalk也不是。
  \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Document authoring and storage}
  In most cases documents are created as a result of
  \begin{itemize}
  \item creative activity of a person with a text processors (authoring);
  \item printing a digital copy or a data record in a database;
  \item aggregation operation over database records (report).
  \end{itemize}
  Then it is stored either as a physical paper and/or a digital document (PDF, DOCX, HTML).

  Since 2000-th, Semantic Web and Linked Open Data (LOD) is being developed, allowing
  \begin{itemize}
  \item structural storage of data within published documents;
  \item processing stored data computationally;
  \item integration of data structures and data objects globally.
  \end{itemize}

  The \textbf{aim of this research} is to develop technologies, software and services allowing construction of digital archives supporting document data inclusion and inference from existing documents.
\end{frame}

\begin{frame}
  \frametitle{Document authoring and storage, 文件编写和存储}
  在大多数情况下，创建文档的结果是
  \begin{itemize}
  \item
文本处理人员的创造性活动（创作）；
  \item
    打印数字副本或数据库中的数据记录；
  \item
        对数据库记录进行汇总操作（报告）。
  \end{itemize}
然后 以实体纸张和/或数字文档（PDF、DOCX、HTML）的形式存储。

  自2000年以来，语义网（Semantic Web）和关联开放数据（Linked Open Data，LOD）得到了发展，从而可以
  \begin{itemize}
  \item
    在已发布的文档中以结构化方式存储数据；
  \item
 计算处理存储的数据；
  \item
        在全球范围内整合数据结构和数据对象。
  \end{itemize}

  The aim of this research is to develop technologies, software and services allowing construction of digital archives supporting document data inclusion and inference from existing documents.
  这项研究的目的是开发技术、软件和服务，以便构建数字档案，
  支持文件数据的包含和现有文件的推理。
\end{frame}

\begin{frame}
  \frametitle{Structure of a document, 文件结构}
  \centering
  \includegraphics[width=1\linewidth]{document-structural-view.pdf}
\end{frame}

\begin{frame}
  \frametitle{Open Annotation ontology (oa), 开放注释本体论}
\begin{adjustwidth}{-3em}{-3em}
  \centering
  \includegraphics[width=1\linewidth]{Open-Annotation_CB_Bookmarking_and_Semantically_Tagging_A_webpage_spec20130128.png}
\end{adjustwidth}

\end{frame}

\begin{frame}[fragile,fragile]
  \frametitle{Representation, 代表性}
  % \begin{block}{}
  %   \textbf{Целью} исследования является создание методики разработки процедур трансформации (PD\footnote{Platform [description] model.}) в виде ОО-модулей.
  % \end{block}
  % \begin{columns}
  %   \begin{column}{0.5\linewidth}
  %     % \includegraphics[width=1\linewidth]{pics/scenario-ru-wo-mothur.pdf}
  %   \end{column}
  %   \begin{column}{0.6\linewidth}
  %     Задачи исследования:
  %     \begin{itemize}
  %     \item Изучить синтаксические структуры Logtalk в аспекте структурирования знаний;
  %     \item Предложить методику представления трансформации в виде ОО-модулей;
  %     \item Реализовать библиотеку объектов и классов для МДА;
  %     \item Тестирование библиотеки на примере.
  %     \end{itemize}
  %   \end{column}
  % \end{columns}

\begin{adjustwidth}{-1.5em}{-1.5em}
\begin{minted}[escapeinside=||,fontsize=\btprgsize]{text}
<html lang="ru" xmlns=http://www.w3.org/1999/xhtml
|\GB{xmlns:taa}|=http://irnok.net/engine/rdfa-manipulation
xml:lang="ru" metal:define-macro="page">
<head> . . . . </head>
<body prefix="rdf: http://www.w3.org/1999/...-ns# foaf: http://xmlns.com/foaf/...
imei: imei.html# course: https://irnok.net/college/plan/01..16-...\
%D0\%BA_PB-SM.plm.xml.xlsx-....2.3.1.html#"  resource="#post"
typeof="schema:CreativeWork sioc:Post prov:Entity">
<!-- The application control panel -->

<main lang="ru" resource="#annotation" typeof="oa:Annotation" id="main-doc-cnt">
<div property="oa:hasTarget" resource="#course-work-prog"></div>
<article property="oa:hasBody" typeof="foaf:Document curr:WorkingProgram"
         resource="#course-work-program" id="main-document">
  <div |\GB{taa:content}|="imei:title-page"></div>
  <div |\GB{taa:content}|="imei:neg-UMK"></div>
  <section id="TOC" class="break-after"> <h2>Table of Contents</h2>
    <div id="tableOfContents"></div>
  </section>
  <section id="course-description" resource="#description"
           property="schema:hasPart" typeof="schema:CreativeWork">
    <div property="schema:hasPart" resource="#purpose"
         typeof="dc:Text cnt:ContentAsText" >
      <div property="cnt:chars" datatype="xsd:string">
        <h2 property="dc:title" datatype="xsd:string">
           Aims and objectives of the discipline (module)</h2>
        <p>The aim of teaching the discipline ...</p>
      </div>
   </div>
  . . . . . . . .
\end{minted}
\end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Architecture, 建筑学}
  \begin{adjustwidth}{-2.5em}{-2.5em}
    \begin{center}
      \includegraphics[width=0.5\linewidth]{architecture-mda-lod-ext-tot.pdf}
    \end{center}
  \end{adjustwidth}

% \begin{itemize}
% \item content and metadata repository with SPARQL (6) and full-text search (3); the engines for LOD processing (5) based on the logical inference;
% \item service for analysis of the stored content (2) enriching the archive with semantic information describing the content;
% \item tools for development of LOD applications and their user interfaces (1);
% \item browser based authoring tools (4).
% \end{itemize}
\end{frame}

\begin{frame}
  \frametitle{Generated list of title page preambles, 生成扉页序言列表}
    \begin{adjustwidth}{-2.5em}{-2.5em}
    \begin{center}
      \includegraphics[width=0.7\linewidth]{template-title-pages.jpg}
    \end{center}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Generated part of a course description, 生成课程说明的一部分}
   \begin{adjustwidth}{-2.5em}{-2.5em}
    \begin{center}
      \includegraphics[width=0.7\linewidth]{template-courses.jpg}
    \end{center}
  \end{adjustwidth}
\end{frame}
\begin{frame}
  \frametitle{Imported time distribution for lecture, seminars, \ldots{}, 导入讲座和研讨会的时间分配、 }
   \begin{adjustwidth}{-2.5em}{-2.5em}
    \begin{center}
      \includegraphics[width=0.9\linewidth]{work-program-volume.jpg}
    \end{center}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Complete document, 完整文件}
  \begin{adjustwidth}{-2.5em}{-2.5em}
    \begin{center}
      \begin{columns}
        \begin{column}{0.5\linewidth}
          \includegraphics[width=1\linewidth]{work-program-title.jpg}
        \end{column}
        \begin{column}{0.5\linewidth}
          \includegraphics[width=1\linewidth]{work-program-agreement.jpg}
        \end{column}
    \end{columns}
    \end{center}
  \end{adjustwidth}
\end{frame}

\begin{frame}
  \frametitle{Used ontologies}
  \begin{itemize}
  \item Friend-of-a-friend (\textbf{foaf}) - agent information: individuals, legal entities, program agents.
  \item Provenance (\textbf{prov}) - references between documents.
  \item Dublin Core (\textbf{dc}) - edited annotation mark up.
  \item DBPedia resource (\textbf{dbr}) – references to instant objects and classes.
  \item Schema.org (\textbf{schema}) - Google, Yandex, Yahoo, \emph{etc}. searchable objects, structural elements.
  \item The Bibliographic Ontology (\textbf{bibo}) - literature reference mark up.
\end{itemize}
\end{frame}

\begin{frame}
  \frametitle{使用的本体}
  \begin{itemize}
  \item Friend-of-a-friend (\textbf{foaf}): 代理人信息：个人、法人实体、计划代理人
  \item Provenance (\textbf{prov}): 文件之间的引用
  \item Dublin Core (\textbf{dc}): 编辑的注释标记
  \item DBPedia resource (\textbf{dbr}): 即时对象和类的引用
  \item Schema.org (\textbf{schema}): Google、Yandex、Yahoo 等搜索对象、结构元素
  \item The Bibliographic Ontology (\textbf{bibo}): 文献参考标注
\end{itemize}
\end{frame}



\begin{frame}
\frametitle{Conclusion}
A tools (components) for digital archive implementation, which allows
to device information systems and document processing services
with the following features:
\begin{itemize}
\item load LOD marked up document, extract, store in a graph and index RDF data;
\item retrieve RDF data as triples or as a result of full-text search query;
\item combine existing LOD data and its content in new documents dynamically with browser based context inference machine;
\item use server-site inference machine (Prolog) to process RDF data upon
  request from browser's part of the system;
 % \item organizes a platform for document semantic markup,
\item convert created RDFa marked up HTML5 documents into Excel and Word formats.
 \end{itemize}

   \textbf{Applications}
   \begin{itemize}
 \item Document authoring automation;
 \item Context-depended editing;
   % \item Export into office formats;
 \item Self-organizing global document flows;
 \item Documents as data sources for information systems.

   \end{itemize}
 \end{frame}

\begin{frame}
  \frametitle{结论}
实施数字档案的工具（组件），可以
设备信息系统和文件处理服务
具有以下功能:
\begin{itemize}
\item 加载 LOD 标注文件、提取、存储在图表中并为 RDF 数据编制索引
\item 以三元组或全文搜索查询结果的形式检索 RDF 数据
\item 利用基于浏览器的上下文推理机，将现有 LOD 数据及其内容动态结合到新文件中
\item 使用服务器端推理机（Prolog）处理 RDF 数据。处理 RDF 数据
  % \item organizes a platform for document semantic markup,
\item 将创建的 RDFa 标记 HTML5 文档转换为 Excel 和 Word 格式。
\end{itemize}

  \textbf{Applications}
  \begin{itemize}
  \item 文件编写自动化
  \item 根据上下文进行编辑
  % \item Export into office formats;
  \item 自组织全球文件流
  \item 文件作为信息系统的数据源
  \end{itemize}

\end{frame}

% \begin{frame}
%   \frametitle{Conclusion}
%   The following results have been obtained as for today:
%   \begin{itemize}
%   \item A technique for model representation has been developed and tested.
%   \item A programming technique using object-oriented logical language Logtalk is deviced.
%   \item Ptototypes of various transformation procedures are implemented.
%   \item Transformation tools are tested in application areas and no significant technical problems were mentioned.
%   \end{itemize}
%   Further development directions are as follows:
%   \begin{itemize}
%   \item A technique for document automatic markup with vocabulary entities.
%   \item A transformation implemenation techniques, minimizing usage of dynamic objects, targeting on macro properties of Logtalk.
%   \item Form a toolset out of existing prototypes obeing nowadays software development requirements.
%   \end{itemize}
%   The source codes are available at \url{https://github.com/isu-enterprise/icc.xmitransform}, \url{https://github.com/eugeneai/icc.mothurpim}.
% \end{frame}



\begin{frame}
  \frametitle{Tabby{XL}}
  \vfill
  \begin{center}
    {\bfseries Software Platform for Rule-Based Spreadsheet Data Extraction and Transformation}\\
    {\bfseries 基于规则的电子表格数据提取和转换软件平台}\\
    \medskip
     Alexey Shigarov, Vasiliy Khristyuk, \emph{et al.}\\
    \medskip
    \texttt{shigarov@icc.ru} % Your email address
  \end{center}
  \vfill
\end{frame}

\begin{frame}
\frametitle{Motivation}
\begin{itemize}
\item About arbitrary spreadsheet tables
\begin{itemize}
	\item A large volume of valuable data for science and business applications
	\item A big variety of layout, style, and content features
	\item Human-centeredness (incorrect structure and messy content)
	\item No explicit semantics for interpretation by computers
\end{itemize}
\bigskip
\item Challenges
\begin{itemize}
	\item How to extract tables from worksheets
	\item How to recognize and correct cell structure anomalies
	\item How to recover semantics needed for the automatic interpretation
	\item How to conceptualize extracted data by using external vocabularies
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{动机}
\begin{itemize}
\item 关于任意电子表格表格
\begin{itemize}
	\item 为科学和商业应用提供大量宝贵数据
	\item 丰富多样的布局、风格和内容功能
	\item 以人为本（结构不正确，内容杂乱无章）
	\item 没有明确的语义供计算机解释
\end{itemize}
\bigskip
\item 挑战
\begin{itemize}
	\item 如何从工作表中提取表格
	\item 如何识别和纠正细胞结构异常
	\item 如何恢复自动解释所需的语义
	\item 如何使用外部词汇表将提取的数据概念化
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Background}
\emph{Table understanding} includes the following tasks
\bigskip
\begin{enumerate}
	\item \textbf{Extraction}, detecting a table and recognizing the physical structure of its cells
	\item \textbf{Role analysis}, extracting functional data items from cell content
	\item \textbf{Structural analysis}, recovering internal relationships between extracted functional data items
	\item \textbf{Interpretation}, linking extracted functional data items with external vocabularies (general-purpose or domain-specific ontologies)
\end{enumerate}
\end{frame}

\begin{frame}
\frametitle{背景介绍}
\emph{表格理解} 包括以下任务
\bigskip
\begin{enumerate}
	\item \textbf{提取}: 检测表格并识别其单元格的物理结构
	\item \textbf{角色分析}:  从单元格内容中提取功能数据项
	\item \textbf{结构分析}: 恢复提取的功能数据项之间的内部关系
	\item \textbf{口译}: 将提取的功能数据项与外部词汇表\\（通用或特定领域本体）连接起来
\end{enumerate}
\end{frame}

% \begin{frame}
% \frametitle{Background}
% The related issues of the \emph{table analysis and interpretation}
% \bigskip
% {\footnotesize
% \begin{itemize}
% \item \textbf{Layout properties} \cite{Koci2017,Chen2017,Dou2018}
% \item \textbf{Code smells and formulas} \cite{Hermans2015,Dou2017,Barowy2018,Koch2019}
% \item \textbf{Programming by examples} \cite{Barowy2015,Singh2016,Jin2017}
% \item \textbf{Data model inference} \cite{Amalfitano2015,Cunha2015,Cunha2016}
% \item \textbf{Linked Open Data} \cite{Ritze2017,Zhang2017}
% \item \textbf{Domain-specific models} \cite{Vos2017,Cao2017,Swidan2017}
% \item \textbf{Rule-based programming} \cite{Yang2017,Shigarov2017,Yang2018}
% \end{itemize}
% }
% \end{frame}

% \begin{frame}
% \frametitle{Background}
% The projects with goals similar to ours
% \bigskip

% \begin{enumerate}
% \item \footnotesize{\textbf{TANGO}\footnote{\url{https://tango.byu.edu}} (Data Extraction Group, Brigham Young University) \textit{2005 -- 2016}}
% \begin{itemize}
% \item \scriptsize{Heuristics-based role analysis (pre-defined functional cell regions) \cite{Embley2016}}
% \end{itemize}
% \item \footnotesize{\textbf{Senbazuru}\footnote{\url{http://dbgroup.eecs.umich.edu/project/sheets}} (Database Research Group, University of Michigan) \textit{2013 -- 2017}}
% \begin{itemize}
% \item \scriptsize{ML-based role analysis (pre-defined functional cell regions) \cite{Chen2016}}
% \item \scriptsize{ML-based structural analysis (pre-defined layout properties of the header hierarchy) \cite{Chen2016}}
% \end{itemize}
% \item \footnotesize{\textbf{DeExcelerator}\footnote{\url{https://wwwdb.inf.tu-dresden.de/research-projects/deexcelarator}} (Dresden Database Systems Group, TU Dresden) \textit{2013 -- 2019}}
% \begin{itemize}
% \item \scriptsize{ML-based layout identification}~\cite{Koci2016}
% \item \scriptsize{Heuristics-based role and structural analysis (pre-defined functional cell regions) \cite{Koci2017,Koci2018}}
% \end{itemize}
% \end{enumerate}

% \end{frame}


% \subsection{Contribution}

\begin{frame}
\frametitle{Contribution}
\small TabbyXL is a software platform aiming at the development and execution of rule-based programs for spreadsheet data extraction and transformation from arbitrary (\textit{a}) to relational tables (\textit{b})
\begin{columns}[c] % The "c" option specifies centered vertical alignment while the "t" option is used for top vertical alignment
\column{.4\textwidth} % Left column and width
\begin{block}{\small Novelty}
\begin{itemize}
\item \small Table object model assigning roles to data items, not cell
\item \small CRL, domain-specific language to express user-defined rules for table analysis and interpretation
\item \small CRL-to-Java translator to synthesize executable programs for spreadsheet data transformation
\end{itemize}
\end{block}
\column{.6\textwidth} % Right column and width
%\begin{figure}
\includegraphics[width=0.85\linewidth]{intro}
%\end{figure}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{捐款}
\small TabbyXL 是一个软件平台，旨在开发和执行基于规则的程序，\\
用于电子表格数据提取和从任意表（a）到关系表（b）的转换。
\vspace{1em}
\begin{columns}[c] % The "c" option specifies centered vertical alignment while the "t" option is used for top vertical alignment
\column{.4\textwidth} % Left column and width
\begin{block}{\small Novelty}
\begin{itemize}
\item \small 为数据项而非单元格分配\\角色的表格对象模型
\item \small CRL，特定领域语言，\\ 用于表达用户定义的\\表格分析和解释规则
\item \small CRL 到 Java 翻译器，用于合成电子\\
  表格数据转换的\\可执行程序
\end{itemize}
\end{block}
\column{.6\textwidth} % Right column and width
%\begin{figure}
\includegraphics[width=0.85\linewidth]{intro}
%\end{figure}
\end{columns}
\end{frame}

% \section{Approach}

%\subsection{User-Defined Rules}

% \begin{frame}
% \frametitle{User-Defined Rules}
% \begin{itemize}
% \item The user-defined rules map the physical structure into the logical structure of a table
% \begin{itemize}
% \item \textbf{WHEN-part} queries facts about the structure by using constraints
% \item \textbf{THEN-part} modifies available facts and asserted new ones
% \end{itemize}
% \item The facts are represented by items of the \emph{table object model}
% \item The rules can be expressed in a rule-based language
% (e.g. Drools\footnote{\url{https://www.drools.org}}, Jess\footnote{\url{https://jessrules.com}}, or CRL\footnote{\url{https://github.com/tabbydoc/tabbyxl/wiki/crl-language}})
% \end{itemize}
% \end{frame}

% \subsection{Table Object Model}

\begin{frame}
\frametitle{Table Object Model}
\begin{columns}[c] % The "c" option specifies centered vertical alignment while the "t" option is used for top vertical alignment
\column{.4\textwidth} % Left column and width
\begin{block}{\small Physical Layer}
\small Cells characterized by layout, style, and content features
\end{block}
\begin{block}{\small Logical Layer}
\small Functional data items and their relationships:
\begin{itemize}
	\item \small entries (values)
	\item \small labels (keys)
	\item \small categories (concepts)
	\item \small entry-label pairs
	\item \small label-label pairs
	\item \small label-category pairs
\end{itemize}
\end{block}
\column{.6\textwidth} % Right column and width
%\begin{figure}
\includegraphics[width=0.85\linewidth]{tom}
%\end{figure}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{表格对象模型}
\begin{columns}[c] % The "c" option specifies centered vertical alignment while the "t" option is used for top vertical alignment
\column{.4\textwidth} % Left column and width
\begin{block}{\small 物理层}
\small 以布局、样式和内容为特征的\\单元格
\end{block}
\begin{block}{\small 逻辑层}
\small 功能数据项及其关系:
\begin{itemize}
	\item \small 条目（数值）
	\item \small 标签（键）
	\item \small 类别（概念）
	\item \small 条目标签对
	\item \small 标签-标签对
	\item \small 标签-类别对
\end{itemize}
\end{block}
\column{.6\textwidth} % Right column and width
%\begin{figure}
\includegraphics[width=0.85\linewidth]{tom}
%\end{figure}
\end{columns}
\end{frame}


\begin{frame}
\frametitle{CRL Grammar}
%\begin{figure}
\includegraphics[width=0.75\linewidth]{BNF}
%\end{figure}
\end{frame}

% \subsection{Cell Cleansing}
\begin{frame}[fragile]
\frametitle{Cell Cleansing}
The actions correct an inaccurate layout and content of a hand-coded table
\begin{itemize}
	\item \alert{<merge>} combines two adjacent cells when they share one border
	\item \alert{<split>} divides a merged cell that spans $n$-tiles (row-column intersections) into $n$-cells
	\item \alert{<set text>} modifies a textual content of a cell
	\item \alert{<set indent>} modifies a text indentation of a cell
\end{itemize}
\footnotesize{
\begin{example}
\begin{alltt}
\textbf{when}
  \textbf{cell} corner: cl == 1, rt == 1, blank
  \textbf{cell} c: cl > corner.cr, rt > corner.rb
\textbf{then}
  \textbf{split} c
\end{alltt}
\end{example}
}
\end{frame}

% \subsection{Cell Cleansing}
\begin{frame}[fragile]
\frametitle{细胞清洁}
这些操作可纠正手工编码表格中不准确的布局和内容
\begin{itemize}
	\item \alert{<merge>} 当相邻两个单元格共享一个边界时，将其合并
	\item \alert{<split>} 将跨 $n$ 格（行列交叉点）的合并单元格划分为 $n$ 单元格
	\item \alert{<set text>} 修改单元格的文本内容
	\item \alert{<set indent>} 修改单元格的文本缩进
\end{itemize}
\footnotesize{
\begin{example}
\begin{alltt}
\textbf{when}
  \textbf{cell} corner: cl == 1, rt == 1, blank
  \textbf{cell} c: cl > corner.cr, rt > corner.rb
\textbf{then}
  \textbf{split} c
\end{alltt}
\end{example}
}
\end{frame}

% \subsection{Role Analysis}

\begin{frame}[fragile]
\frametitle{Role Analysis}
The actions recover entries and labels as functional data items presented in a table
\begin{itemize}
	\item \alert{<set mark>} annotates a cell with a user-defined tag that can be used in subsequent table analysis
	\item \alert{<new entry>} (\alert{<new label>}) creates an entry (label) from a cell content with the use of an optional string processing
\end{itemize}
\footnotesize{
\begin{example}
\begin{alltt}
\textbf{when}
  \textbf{cell} corner: cl == 1, rt == 1, blank
  \textbf{cell} c: cl > corner.cr, rt > corner.rb
\textbf{then}
  \textbf{new entry} c
\end{alltt}
\end{example}
}
\end{frame}

\begin{frame}[fragile]
\frametitle{角色分析}
操作恢复作为功能数据项的条目和标签，以表格形式呈现
\begin{itemize}
	\item \alert{<set mark>} 为单元格标注用户定义的标签，该标签可用于后续表格分析
	\item \alert{<new entry>} (\alert{<new label>}) 使用可选的字符串处理，从单元格内容创建条目（标签）。
\end{itemize}
\footnotesize{
\begin{example}
\begin{alltt}
\textbf{when}
  \textbf{cell} corner: cl == 1, rt == 1, blank
  \textbf{cell} c: cl > corner.cr, rt > corner.rb
\textbf{then}
  \textbf{new entry} c
\end{alltt}
\end{example}
}
\end{frame}

% \subsection{Structural Analysis}


\begin{frame}[fragile]
\frametitle{Structural Analysis}
The actions recover pairs of two kinds: entry-label and label-label
\begin{itemize}
	\item \alert{<add label>} associates an entry with a label
	\item \alert{<set parent>} binds two labels as a parent and its child
\end{itemize}
\footnotesize{
\begin{example}
\begin{alltt}
\textbf{when}
  \textbf{cell} c1: cl == 1
  \textbf{cell} c2: cl == 1, rt > c1.rt, indent == c1.indent + 2
  \textbf{no cells}: cl == 1, rt > $c1.rt, rt < $c2.rt, indent == $c1.indent
\textbf{then}
  \textbf{set parent} c1.label \textbf{to} c2.label
\end{alltt}
\end{example}
}
\end{frame}

\begin{frame}[fragile]
\frametitle{结构分析}
恢复的操作对有两种：条目-标签和标签-标签
\begin{itemize}
	\item \alert{<add label>} 将条目与标签关联
	\item \alert{<set parent>} 将两个标签绑定为父标签和子标签
\end{itemize}
\footnotesize{
\begin{example}
\begin{alltt}
\textbf{when}
  \textbf{cell} c1: cl == 1
  \textbf{cell} c2: cl == 1, rt > c1.rt, indent == c1.indent + 2
  \textbf{no cells}: cl == 1, rt > $c1.rt, rt < $c2.rt, indent == $c1.indent
\textbf{then}
  \textbf{set parent} c1.label \textbf{to} c2.label
\end{alltt}
\end{example}
}
\end{frame}


% \subsection{Interpretation}

\begin{frame}[fragile]
\frametitle{Interpretation}
The actions serve to recover label-category pairs
\begin{itemize}
	\item \alert{<set category>} associates a label with a category
	\item \alert{<group>} places two labels to one group that can be considered as an undefined category
\end{itemize}
\footnotesize{
\begin{example}
\begin{alltt}
\textbf{when}
  \textbf{label} l1: cell.mark == "stub"
  \textbf{label} l2: cell.mark == "stub", cell.rt == l1.cell.rt
\textbf{then}
  \textbf{group} l1 \textbf{with} l2
\end{alltt}
\end{example}
}
\end{frame}

\begin{frame}[fragile]
\frametitle{口译}
这些操作有助于恢复标签-类别对
\begin{itemize}
	\item \alert{<set category>} 将标签与类别关联
	\item \alert{<group>} 将两个标签贴在一个可视为未定义类别的组上
\end{itemize}
\footnotesize{
\begin{example}
\begin{alltt}
\textbf{when}
  \textbf{label} l1: cell.mark == "stub"
  \textbf{label} l2: cell.mark == "stub", cell.rt == l1.cell.rt
\textbf{then}
  \textbf{group} l1 \textbf{with} l2
\end{alltt}
\end{example}
}
\end{frame}
% \subsection{Illustrative Example}

\begin{frame}
\frametitle{Illustrative Example}
\scriptsize{The transformation of arbitrary tables with the same layout features (\textit{a} and \textit{c}) to their canonical versions (\textit{b} and \textit{d})}
\begin{figure}
\includegraphics[width=0.7\linewidth]{illustrative_example}
\end{figure}
\scriptsize{The ruleset for the cell cleansing (\textit{a}), role analysis (\textit{b}, \textit{c}), structural analysis (\textit{d}, \textit{e}), and interpretation (\textit{f}, \textit{g})}
\begin{figure}
\includegraphics[width=0.75\linewidth]{illustrative_example_rules}
\end{figure}
\scriptsize{This example is reproducible at \url{https://codeocean.com/capsule/5326436}}
\end{frame}

\begin{frame}
\frametitle{示例}
\scriptsize{将具有相同布局特征的任意表格（(a) 和 (c)）转换为其规范版本（(b) 和 (d)}
\begin{figure}
\includegraphics[width=0.7\linewidth]{illustrative_example}
\end{figure}
\scriptsize{细胞清洗的规则集 (\textit{a}), 角色分析 (\textit{b}, \textit{c}), 结构分析 (\textit{d}, \textit{e}), 和解释 (\textit{f}, \textit{g})}
\begin{figure}
\includegraphics[width=0.75\linewidth]{illustrative_example_rules}
\end{figure}
\scriptsize{该示例可在以下网址复制 \url{https://codeocean.com/capsule/5326436}}
\end{frame}

% \section{Software Platform}

% \subsection{Architecture}

\begin{frame}
\frametitle{Architecture}
%\begin{figure}
\includegraphics[width=1.0\linewidth]{architecture}
%\end{figure}
\hspace*{\fill} \textbf{Two options are provided} \hspace*{\fill}
\begin{columns}
\column{.5\textwidth}
\begin{block}{\small Rule Engine option}
\small Executing a ruleset in an appropriate format with a JSR-94 compatible rule engine (e.g. Drools, Jess)
\end{block}
\column{.4\textwidth}
\begin{block}{\small CRL2J option}
\small Translating a ruleset expressed in CRL to an executable Java program
\end{block}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{建筑学}
%\begin{figure}
\includegraphics[width=1.0\linewidth]{architecture}
%\end{figure}
\hspace*{\fill} \textbf{提供两种选择} \hspace*{\fill}
\begin{columns}
\column{.5\textwidth}
\begin{block}{\small 规则引擎选项}
\small 使用与 JSR-94 兼容的规则引擎（如 Drools、Jess）以适当格式执行规则集
\end{block}
\column{.4\textwidth}
\begin{block}{\small CRL2J 选择权}
\small 将 CRL 表达的规则集转换为可执行 Java 程序
\end{block}
\end{columns}
\end{frame}



%\subsection{CRL2J Translation}

\begin{frame}
\frametitle{CRL2J Translation}
\begin{columns}[t]
\column{.55\textwidth}
\small Workflow for generating a Maven-project of a spreadsheet data transformation program
\begin{figure}
\includegraphics[width=0.95\linewidth]{crl2j_wf_part1}
\end{figure}

\column{.05\textwidth}
\\~\\

\column{.4\textwidth}
\small Workflow for translating a CRL ruleset to Java source code
\begin{figure}
\includegraphics[width=0.95\linewidth]{crl2j_wf_part2}
\end{figure}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{CRL2J 翻译}
\begin{columns}[t]
\column{.55\textwidth}
\small 生成电子表格数据转换程序 Maven 项目的工作流程
\begin{figure}
\includegraphics[width=0.95\linewidth]{crl2j_wf_part1}
\end{figure}

\column{.05\textwidth}
\\~\\

\column{.4\textwidth}
\small 将 CRL 规则集转换为 Java 源代码的工作流程
\begin{figure}
\includegraphics[width=0.95\linewidth]{crl2j_wf_part2}
\end{figure}
\end{columns}
\end{frame}

\begin{frame}

\frametitle{CRL2J Translation}

\begin{columns}
\column{.3\textwidth}
\small{\centerline{In the Workflow}}

\begin{figure}
\includegraphics[width=0.65\linewidth]{rom_in_wf.eps}
\end{figure}

\column{.7\textwidth}
\small{\centerline{Rule Object Model}}

\begin{figure}
\includegraphics[width=0.8\linewidth]{rulemodel}
\end{figure}
\end{columns}

\end{frame}

\begin{frame}

\frametitle{CRL2J 翻译}

\begin{columns}
\column{.3\textwidth}
\small{\centerline{在工作流程中}}

\begin{figure}
\includegraphics[width=0.65\linewidth]{rom_in_wf.eps}
\end{figure}

\column{.7\textwidth}
\small{\centerline{规则对象模型}}

\begin{figure}
\includegraphics[width=0.8\linewidth]{rulemodel}
\end{figure}
\end{columns}

\end{frame}

\begin{frame}[fragile] % Need to use the fragile option when verbatim is used in the slide
\frametitle{CRL2J Translation}

\footnotesize{
\begin{example}[Source Rule]
\begin{alltt}
\textbf{when}
  \textbf{cell} corner: cl == 1, rt == 1, blank
  \textbf{cell} c: cl > corner.cr, rt > corner.rb, ! marked
\textbf{then}
  \textbf{set mark} "@entry" \textbf{to} c
  \textbf{new entry} c
\end{alltt}
\end{example}
}
\footnotesize{
\begin{example}[Fragment of the Generated Java Code]
\begin{alltt}
...
Iterator<CCell> iterator1 = getTable().getCells();
\textbf{while} (iterator1.hasNext()) \{
  corner = iterator1.next();
  \textbf{if} ((corner.getCl() == 1) && (corner.getRt() == 1) && ...
    Iterator<CCell> iterator2 = getTable().getCells();
    \textbf{while} (iterator2.hasNext()) \{
...
\end{alltt}
\end{example}
}
\end{frame}

\begin{frame}[fragile] % Need to use the fragile option when verbatim is used in the slide
\frametitle{CRL2J 翻译}

\footnotesize{
\begin{example}[来源规则]
\begin{alltt}
\textbf{when}
  \textbf{cell} corner: cl == 1, rt == 1, blank
  \textbf{cell} c: cl > corner.cr, rt > corner.rb, ! marked
\textbf{then}
  \textbf{set mark} "@entry" \textbf{to} c
  \textbf{new entry} c
\end{alltt}
\end{example}
}
\footnotesize{
\begin{example}[生成的 Java 代码片段]
\begin{alltt}
...
Iterator<CCell> iterator1 = getTable().getCells();
\textbf{while} (iterator1.hasNext()) \{
  corner = iterator1.next();
  \textbf{if} ((corner.getCl() == 1) && (corner.getRt() == 1) && ...
    Iterator<CCell> iterator2 = getTable().getCells();
    \textbf{while} (iterator2.hasNext()) \{
...
\end{alltt}
\end{example}
}
\end{frame}

%------------------------------------------------

% \section{Empirical Results}

% \subsection{Performance Evaluation}

\begin{frame}
\frametitle{Performance Evaluation}
\small{The results of the transformation of 200 tables of Troy200 dataset}
\footnotesize{
\begin{table}
		\centering
		    \bgroup
        \def\arraystretch{1.5}
				\begin{tabular}{|l|c|c|c|c|}
						\hline
														& \multicolumn{2}{|c|}{Role analysis} & \multicolumn{2}{|c|}{Structural analysis} \\
														\cline{2-5}
														& \multicolumn{4}{|c|}{Type of instances} \\
														\cline{2-5}
			            Metrics   & entries                      & labels                     & entry-label pairs            & label-label pairs  \\
			      \hline
			            Recall    & 0.9813 $\frac{16602}{16918}$ & 0.9965 $\frac{4842}{4859}$ & 0.9773 $\frac{34270}{35066}$ & 0.9389 $\frac{1951}{2078}$ \\
			            Precision & 0.9996 $\frac{16602}{16609}$ & 0.9364 $\frac{4842}{5171}$ & 0.9965 $\frac{34270}{34389}$ & 0.9784 $\frac{1951}{1994}$ \\
									$F$-score & 0.9904                       & 0.9655                     & 0.9868                       & 0.9582                     \\
			      \hline
		    \end{tabular}
				\egroup
\end{table}
}
\begin{block}{\small Metrics}
\footnotesize{
\begin{equation*}
\begin{aligned}[c]
\text{recall} = \frac{\left|R \cap S\right|}{\left|S\right|}
\end{aligned}
\quad
\begin{aligned}[c]
\text{precision} = \frac{\left|R \cap S\right|}{\left|R\right|}
\end{aligned}
\end{equation*}
}
\scriptsize{\centerline{$S$ is a set of instances in a source table, $R$ is a set of instances in its canonical form}}
\end{block}
\tiny All data and steps to reproduce the results are available at \url{http://dx.doi.org/10.17632/ydcr7mcrtp.5}
\end{frame}

\begin{frame}
\frametitle{绩效评估}
\small{Troy200 数据集 200 个表格的转换结果}
\footnotesize{
\begin{table}
		\centering
		    \bgroup
        \def\arraystretch{1.5}
				\begin{tabular}{|l|c|c|c|c|}
						\hline
														& \multicolumn{2}{|c|}{角色分析} & \multicolumn{2}{|c|}{结构分析} \\
														\cline{2-5}
														& \multicolumn{4}{|c|}{实例类型} \\
														\cline{2-5}
			            衡量标准   & 参赛                      & 标签                     & 条目标签对            & 标签-标签对  \\
			      \hline
			            回顾    & 0.9813 $\frac{16602}{16918}$ & 0.9965 $\frac{4842}{4859}$ & 0.9773 $\frac{34270}{35066}$ & 0.9389 $\frac{1951}{2078}$ \\
			            精确度 & 0.9996 $\frac{16602}{16609}$ & 0.9364 $\frac{4842}{5171}$ & 0.9965 $\frac{34270}{34389}$ & 0.9784 $\frac{1951}{1994}$ \\
									$F$-总谱 & 0.9904                       & 0.9655                     & 0.9868                       & 0.9582                     \\
			      \hline
		    \end{tabular}
				\egroup
\end{table}
}
\begin{block}{\small Metrics}
\footnotesize{
\begin{equation*}
\begin{aligned}[c]
\text{回顾} = \frac{\left|R \cap S\right|}{\left|S\right|}
\end{aligned}
\quad
\begin{aligned}[c]
\text{精确度} = \frac{\left|R \cap S\right|}{\left|R\right|}
\end{aligned}
\end{equation*}
}
\scriptsize{\centerline{$S$ 是源表中的一组实例, $R$ 是一组典型形式的实例}}
\end{block}
\tiny 所有数据和重现结果的步骤可从以下网址获取 \url{http://dx.doi.org/10.17632/ydcr7mcrtp.5}
\end{frame}

\begin{frame}
\frametitle{Performance Evaluation}
\small{The comparison of the running time by using TabbyXL with three different options for transforming 200 tables of Troy200 dataset %\cite{Nagy2016}%
}
\begin{table}
		\centering
		    \bgroup
        \def\arraystretch{1.5}
				\begin{tabular}{|l|c|c|c|}
						\hline
									Running time of             & CRL2J   & Drools  & Jess     \\
						\hline
									Ruleset preparation ($t_1$) & 2108* ms & $1711^\dagger$ ms & $432^\dagger$  ms \\
                  Ruleset execution ($t_2$)   & 367** ms & $1974^\ddagger$ ms & $4149^\ddagger$ ms \\
			      \hline
		    \end{tabular}
				\egroup
\end{table}
\scriptsize{
* $t_1$ --- a time of parsing and compiling the original ruleset into a Java program \\
** $t_2$ --- a time of executing the generated Java program
\\~\\
$^\dagger$ $t_1$ --- a time of parsing the original ruleset and adding the result into a rule engine session \\
$^\ddagger$ $t_2$ --- a time of asserting facts into the working memory and matching rules against the facts
\\~\\
For testing, we used 3.2 GHz 4-core CPU
}
\end{frame}

\begin{frame}
\frametitle{绩效评估}
\small{使用 TabbyXL 对 Troy200 数据集的 200 张表格进行转换时，三种不同选项的运行时间比较 %\cite{Nagy2016}%
}
\begin{table}
		\centering
		    \bgroup
        \def\arraystretch{1.5}
				\begin{tabular}{|l|c|c|c|}
						\hline
									运行时间             & CRL2J   & Drools  & Jess     \\
						\hline
									规则集准备 ($t_1$) & 2108* ms & $1711^\dagger$ ms & $432^\dagger$  ms \\
                  规则集执行 ($t_2$)   & 367** ms & $1974^\ddagger$ ms & $4149^\ddagger$ ms \\
			      \hline
		    \end{tabular}
				\egroup
\end{table}
\scriptsize{
* $t_1$ --- 解析原始规则集并将其编译成 Java 程序的时间 \\
** $t_2$ --- 执行生成的 Java 程序的时间
\\~\\
$^\dagger$ $t_1$ --- 解析原始规则集并将结果添加到规则引擎会话的时间 \\
$^\ddagger$ $t_2$ --- 在工作记忆中断言事实并将规则与事实相匹配的时间
\\~\\
在测试中，我们使用了主频为 3.2 GHz 的 4 核 CPU
}
\end{frame}

% \subsection{Comparison with Others}

\begin{frame}
\frametitle{Comparison with Others}

\small{
\begin{block}{Role Analysis}
\begin{itemize}
\item \emph{Contest task}: The segmentation of a table into typical functional cell regions
\item \emph{Testing dataset}: Troy200  % \cite{Nagy2016}
\item \emph{Contestant}: MIPS (TANGO) % \cite{Embley2016}
\item \emph{Accuracy}: MIPS (TANGO) --- \textbf{0.9899} vs. TabbyXL --- \textbf{0.9950}
\end{itemize}
\end{block}

\begin{block}{Structural Analysis}
\begin{itemize}
	\item \emph{Contest task}: The extraction of header hierarchies from tables
	\item \emph{Testing dataset}: A random subset of SAUS\footnote{\url{http://dbgroup.eecs.umich.edu/project/sheets/datasets.html}}
	\item \emph{Contestant}: Senbazuru % \cite{Chen2014}
	\item $F$\emph{-score}: Senbazuru --- \textbf{0.8860} vs. TabbyXL --- \textbf{0.8657}
\end{itemize}
\end{block}
}
\end{frame}

\begin{frame}
\frametitle{与他人比较}

\small{
\begin{block}{角色分析}
\begin{itemize}
\item \emph{竞赛任务}: 将表格划分为典型的功能单元区域
\item \emph{测试数据集}: Troy200  % \cite{Nagy2016}
\item \emph{参赛者}: MIPS (TANGO) % \cite{Embley2016}
\item \emph{准确性}: MIPS (TANGO) --- \textbf{0.9899} vs. TabbyXL --- \textbf{0.9950}
\end{itemize}
\end{block}

\begin{block}{Structural Analysis}
\begin{itemize}
	\item \emph{竞赛任务}: 从表格中提取表头层次结构
	\item \emph{测试数据集}: 的一个随机子集 SAUS\footnote{\url{http://dbgroup.eecs.umich.edu/project/sheets/datasets.html}}
	\item \emph{参赛者}: Senbazuru % \cite{Chen2014}
	\item $F$\emph{-总谱}: Senbazuru --- \textbf{0.8860} vs. TabbyXL --- \textbf{0.8657}
\end{itemize}
\end{block}
}
\end{frame}

% \section{Application Experience}

\begin{frame}
\frametitle{Application Experience}
Populating a web-based statistical atlas of the Irkutsk region --- (\textit{b}) via extracting data from government statistical reports --- (\textit{a})
\begin{figure}
\includegraphics[width=1\linewidth]{application1}
\end{figure}
\tiny{The more detail can be found at \url{https://github.com/tabbydoc/tabbyxl/wiki/statistical-atlas}}
\end{frame}

\begin{frame}
\frametitle{应用体验}
绘制伊尔库茨克州网络统计地图集 --- (\textit{b}) 通过从政府统计报告中提取数据 --- (\textit{a})
\begin{figure}
\includegraphics[width=1\linewidth]{application1}
\end{figure}
\tiny{更多详情请访问 \url{https://github.com/tabbydoc/tabbyxl/wiki/statistical-atlas}}
\end{frame}

\begin{frame}
\frametitle{Application Experience}
Generating conceptual models --- (\textit{b}) from arbitrary tables presented in industrial safety inspection reports --- (\textit{a})
\begin{figure}
\includegraphics[width=1\linewidth]{application2}
\end{figure}
\tiny{The more detail can be found at \url{https://github.com/tabbydoc/tabbyxl/wiki/industrial-safety-inspection}}
\end{frame}

\begin{frame}
\frametitle{应用体验}
生成概念模型 --- (\textit{b}) 来自工业安全检查报告中的任意表格 --- (\textit{a})
\begin{figure}
\includegraphics[width=1\linewidth]{application2}
\end{figure}
\tiny{更多详情请访问 \url{https://github.com/tabbydoc/tabbyxl/wiki/industrial-safety-inspection}}
\end{frame}

% \section{Conclusions \& Further Work}

\begin{frame}
\frametitle{Conclusions \& Further Work}

\begin{itemize}
\item Impact on software development for spreadsheet data management
\begin{itemize}
\item Table object model associating functional roles with data items
\item Table analysis and interpretation driven by user-defined rules
\item Formulated actions to recover missing semantics of arbitrary tables
\item Translation of rules to executable spreadsheet transformation programs
\end{itemize}
\medskip
\item Limitations
\begin{itemize}
\item The inaccurate cell structure prevents the table analysis
\item The very limited interpretation (without external vocabularies)
\end{itemize}
\medskip
\item Further work
\begin{itemize}
\item Rearrangement of cell structure by using visual (human-readable) cells
\item Detecting derived data by spreadsheet formulas
\item Enriching the table analysis by named entity recognition
\item Linking extracted data items with LOD cloud
\end{itemize}
\end{itemize}

\end{frame}

\begin{frame}
\frametitle{结论和下一步工作}

\begin{itemize}
\item 对电子表格数据管理软件开发的影响
\begin{itemize}
\item 将功能角色与数据项关联起来的表对象模型
\item 根据用户定义的规则进行表格分析和解释
\item 为恢复任意表的缺失语义而制定的行动
\item 将规则转化为可执行的电子表格转换程序
\end{itemize}
\medskip
\item 局限性
\begin{itemize}
\item 不准确的单元格结构妨碍了表格分析
\item 非常有限的解释（没有外部词汇表）
\end{itemize}
\medskip
\item 进一步的工作
\begin{itemize}
\item 利用可视（人类可读）细胞重新排列细胞结构
\item 通过电子表格公式检测派生数据
\item 通过命名实体识别丰富表格分析
\item 将提取的数据项与 LOD 云连接起来
\end{itemize}
\end{itemize}

\end{frame}

% \section{References}

% \begin{frame}[allowframebreaks]
% \frametitle{References}
% \tiny
% \bibliographystyle{apalike}
% \bibliography{mybibfile}
% \end{frame}

\begin{frame}
\Huge{\centerline{Thanks!}}
\bigskip
\footnotesize{\centerline{Read more about the project at}}
\scriptsize{\centerline{\url{http://td.icc.ru}}}

\bigskip
\footnotesize{\centerline{The project source code is available at}}
\scriptsize{\centerline{\url{https://github.com/tabbydoc/tabbyxl}}}
\bigskip
\begin{center}
  \Large But it is not all $\ldots$
\end{center}
\end{frame}

\begin{frame}
\Huge{\centerline{谢谢!}}
\bigskip
\footnotesize{\centerline{有关该项目的更多信息，请访问}}
\scriptsize{\centerline{\url{http://td.icc.ru}}}

\bigskip
\footnotesize{\centerline{项目源代码见}}
\scriptsize{\centerline{\url{https://github.com/tabbydoc/tabbyxl}}}
\bigskip
\begin{center}
  \Large 但这并不是全部 $\ldots$
\end{center}
\end{frame}


\begin{frame}
  \frametitle{Domain Knowledge Graphs Induction from Tables}
  \textbf{Tables} are the most available sources of information. They \textbf{are} valuable data \textbf{sources} for \textbf{Knowledge Bases} (KB)
  \begin{description}
  \item[Knowledge Base Construction] Populating with document and structured table extracted data
  \item[Knowledge Base Population] Populating with recognized new facts on entities from big text corpses
  \item[Knowledge base Augmentation] Populating with relations with table data.
  \end{description}

{\footnotesize
\begin{enumerate}
\item (Ré, 2014) Ré C., et al. Feature engineering for knowledge base construction. IEEE Data Eng. Bull., 37, 26–40, (2014).
\item    (Balog, 2018) Balog K. Populating knowledge bases. Entity-Oriented Search. INRE, 39, 189–222, (2018).
\item    (Zhang \& Balog, 2020) Zhang S. \& Balog K. Web table extraction, retrieval, and augmentation: A survey. ACM Trans. Intell. Syst. Technol., 11, (2020).
  \end{enumerate}
}
\end{frame}

\begin{frame}
  \frametitle{领域知识图谱 表格归纳法}
  表格是最常用的信息来源。它们是知识库（KB）的重要数据源
  \begin{description}
  \item[知识库建设] 填充文件和结构化表格提取的数据
  \item[知识库人口] 从大文本尸体中填充关于实体的公认新事实
  \item[知识库扩充] 用表格数据填充关系
  \end{description}
\vspace{1em}
{\footnotesize
\begin{enumerate}
\item (Ré, 2014) Ré C., et al. Feature engineering for knowledge base construction. IEEE Data Eng. Bull., 37, 26–40, (2014).
\item    (Balog, 2018) Balog K. Populating knowledge bases. Entity-Oriented Search. INRE, 39, 189–222, (2018).
\item    (Zhang \& Balog, 2020) Zhang S. \& Balog K. Web table extraction, retrieval, and augmentation: A survey. ACM Trans. Intell. Syst. Technol., 11, (2020).
  \end{enumerate}
}
\end{frame}

\begin{frame}
  There three main stages of Automatic table interpretation (Shigarov, 2017)
  \frametitle{Automatic Table Interpretation}

  \includegraphics[width=\linewidth]{table-descr-proc.jpg}

{\footnotesize
\begin{enumerate}
\item (Shigarov, 2017) Shigarov A., Mikhailov A. Rule-based spreadsheet data transformation from arbitrary to relational tables. Information Systems, 71, 123-136 (2017).
\end{enumerate}
}
\end{frame}

\begin{frame}
  \frametitle{自动释表}
自动表格解释有三个主要阶段（Shigarov，2017）

  \includegraphics[width=\linewidth]{table-descr-proc.jpg}

{\footnotesize
\begin{enumerate}
\item (Shigarov, 2017) Shigarov A., Mikhailov A. Rule-based spreadsheet data transformation from arbitrary to relational tables. Information Systems, 71, 123-136 (2017).
\end{enumerate}
}
\end{frame}

\begin{frame}
  \frametitle{Semantic Table Interpretation}

Semantic interpretation (Annotation) of tables (Semantic Table Interpretation, STI) is a recognition of mutual and external relations between elements of table content.  Externals relate to an enterprise KG and/or a global KG (e.g. DBPedia.org).

  \begin{columns}
    \begin{column}{0.4\textwidth}
      \begin{itemize}
      \item Cell-Entity Annotation (CEA)
      \item Column-Type Annotation (CTA)
      \item Column Property Annotation (CPA)
      \item Topic Annotation
      \end{itemize}
    \end{column}
    \begin{column}{0.7\textwidth}
    \includegraphics[width=\linewidth]{table-sem-interp.png}
  \end{column}
\end{columns}
\end{frame}

\begin{frame}
  \frametitle{Semantic Table Interpretation}

  表格的语义解释（注释）(Semantic Table Interpretation，STI)\\
  是对表格内容元素之间相互关系和外部关系的一种确认。 外部关系涉及企业 KG\\
  和/或全局 KG (例如 DBPedia.org)。

  \begin{columns}
    \begin{column}{0.4\textwidth}
      \begin{itemize}
      \item 细胞实体注释（CEA）
      \item 列式注释 (CTA)
      \item 列属性注释 (CPA)
      \item 主题注释
      \end{itemize}
    \end{column}
    \begin{column}{0.7\textwidth}
    \includegraphics[width=\linewidth]{table-sem-interp.png}
  \end{column}
\end{columns}
\end{frame}

\begin{frame}[fragile]
  \frametitle{Cell-Entity Annotation}
  CEA comprises tho sequential steps as follows:
  \begin{enumerate}
  \item Select a candidate entity set from DBPedia.org for each value of a cell via SPARQL endpoint and DBPedia lookup.
  \item Disambiguation
  \end{enumerate}


A SPARQL-query matching words of a phrase.
\begin{minted}{sparql}
SELECT DISTINCT (str(?subject) as ?subject)
WHERE {
    ?subject a ?type .
    ?subject rdfs:label ?label .
    ?label <bif:contains> ".*%value1*." AND ".*%value2*." ... .
    FILTER NOT EXISTS { ?subject dbo:wikiPageRedirects ?r2 } .
    FILTER (!strstarts(str(?subject), "http://dbpedia.org/resource/Category:")) .
    FILTER (!strstarts(str(?subject), "http://dbpedia.org/property/")) .
    FILTER (!strstarts(str(?subject), "http://dbpedia.org/ontology/")) .
    FILTER (strstarts(str(?type), "http://dbpedia.org/ontology/")) .
    FILTER (lang(?label) = "en")
}
ORDER BY ASC(strlen(?label))
LIMIT 100
\end{minted}
\end{frame}

\begin{frame}[fragile]
  \frametitle{细胞实体注释}
  CEA 包括以下三个连续步骤：
  \begin{enumerate}
  \item 通过 SPARQL 端点和 DBPedia 查找，为单元格的每个值从 DBPedia.org 中选择一个候选实体集。
  \item 消歧义
  \end{enumerate}

匹配短语单词的 SPARQL 查询。
\begin{minted}{sparql}
SELECT DISTINCT (str(?subject) as ?subject)
WHERE {
    ?subject a ?type .
    ?subject rdfs:label ?label .
    ?label <bif:contains> ".*%value1*." AND ".*%value2*." ... .
    FILTER NOT EXISTS { ?subject dbo:wikiPageRedirects ?r2 } .
    FILTER (!strstarts(str(?subject), "http://dbpedia.org/resource/Category:")) .
    FILTER (!strstarts(str(?subject), "http://dbpedia.org/property/")) .
    FILTER (!strstarts(str(?subject), "http://dbpedia.org/ontology/")) .
    FILTER (strstarts(str(?type), "http://dbpedia.org/ontology/")) .
    FILTER (lang(?label) = "en")
}
ORDER BY ASC(strlen(?label))
LIMIT 100
\end{minted}
\end{frame}

% ----------------------------------------------------------------------------------

\begin{frame}
  \frametitle{Evaluation on Test Table Sets}

  A well-known precision measurement (\emph{accuracy}) is used for assessment
  \[
\text{Accuracy} = \frac{CC}{NC},
\]

\noindent where $CC$ is the \textbf{number} of the correctly related columns to a categorical entity, and $CN$ is the total \textbf{number} of columns.

\noindent\begin{tblr}
  {width=1\linewidth, colspec={|X[4]|X|X|X|}, column{1}={l}}
  \hline
Recognition stage& \textbf{T2Dv2} & \vbox{Tough\_\\Tables} & \vbox{Git-\\Tables} \\
  \hline
Stage 2, Atomic column classification & \textbf{0.994} & 0.956 & 0.938 \\
  \hline
Stage 3, Column entity identification & \textbf{0.924} & -- & -- \\
  \hline
\end{tblr}
Comparison with analogs

\noindent\begin{tblr}
  {width=1\linewidth, colspec={|X[3]|X|X|X|X|}, column{1}={l}}
  \hline
  & TAIPAN & \vbox{Table-\\Miner+} & \textbf{T2Dv2} & \vbox{Mantis-\\Table} \\
  \hline
 Column entity identification & 0.540 & 0.871 & \textbf{0.924} & 0.979\\
  \hline
\end{tblr}
\end{frame}

\begin{frame}
  \frametitle{Evaluation on Test Table Sets}

  采用众所周知的精确测量（\emph{精度}）进行评估
  \[
\text{准确性} = \frac{CC}{NC},
\]

\noindent 其中，$CC$ 是与分类实体正确相关的列数，$CN$ 是列的总数。

\noindent\begin{tblr}
  {width=1\linewidth, colspec={|X[4]|X|X|X|}, column{1}={l}}
  \hline
认可阶段 & \textbf{T2Dv2} & \vbox{Tough\_\\Tables} & \vbox{Git-\\Tables} \\
  \hline
第 2 阶段，原子柱分类 & \textbf{0.994} & 0.956 & 0.938 \\
  \hline
第 3 阶段，列实体识别 & \textbf{0.924} & -- & -- \\
  \hline
\end{tblr}
与类似物的比较

\noindent\begin{tblr}
  {width=1\linewidth, colspec={|X[3]|X|X|X|X|}, column{1}={l}}
  \hline
 & TAIPAN & \vbox{Table-\\Miner+} & \textbf{T2Dv2} & \vbox{Mantis-\\Table} \\
  \hline
 列实体标识 & 0.540 & 0.871 & \textbf{0.924} & 0.979\\
  \hline
\end{tblr}
\end{frame}

\begin{frame}
  \frametitle{Knowledge Representation and Reasoning: the PCF-Calculus}
  The main properties of the language of positively constructed formulas (PCF) and its calculi:
  \begin{columns}
    \begin{column}{0.5\linewidth}
      \begin{itemize}
      \item PCFs have a large-block structure (tree-like) and consist of only positive quantifiers ∃ and ∀
      \item the PCF-based calculus have a unique inference rule
      \end{itemize}

    \end{column}
    \begin{column}{0.5\linewidth}
      \includegraphics[width=\linewidth]{pcf-block-struct.png}
    \end{column}
  \end{columns}
\begin{itemize}
\item the proof in the PCF-calculus is organized as a question-answering procedure
\item PCF-calculus is both machine-oriented and human-oriented; it is \textbf{compatible with heuristics}
\item the semantic of the PCF-calculus can be changed without modifying axioms and the inference rule
\end{itemize}
\end{frame}

\begin{frame}
  \frametitle{知识表示与推理：PCF 微积分}
  正构造公式（PCF）语言及其计算器的主要特性:
  \begin{columns}
    \begin{column}{0.5\linewidth}
      \begin{itemize}
      \item  PCF 具有大块结构（树状)，\\ 仅由正量词∃ 和 ∀ 组成。
      \item 基于 PCF 的微积分有一个唯一的推理规则
      \end{itemize}
    \end{column}
    \begin{column}{0.5\linewidth}
      \includegraphics[width=\linewidth]{pcf-block-struct.png}
    \end{column}
  \end{columns}
\begin{itemize}
\item PCF 微积分中的证明是以问题解答过程的形式组织的
\item PCF 微积分既面向机器，也面向人类；它与启发式方法兼容
\item 可以在不修改公理和推理规则的情况下改变 PCF 微积分的语义
\end{itemize}
\end{frame}

\begin{frame}[fragile]
  \frametitle{PCF-Based Method for Problem Solving}
   \begin{columns}
     \begin{column}{0.6\textwidth}
       \includegraphics[width=\linewidth]{pcf-robo-planning.pdf}
     \end{column}
     \begin{column}{0.3\textwidth}
       \includegraphics[width=\linewidth]{pcf-room.png}
     \end{column}
   \end{columns}
   \begin{itemize}
   \item The goal of the team  of robot is to transport blocks to the target area
   \item Each block can be dragged by two or more robots
   \item The current state of the  World and the goal of the group are formalized in PCF
   \item The PCF-based prover and a selection mechanism produce the optimal joint plan of actions for the team
   \item The current plan can be easily modified whenever the state of the World is changed
   \end{itemize}
 \end{frame}

\begin{frame}[fragile]
  \frametitle{基于 PCF 的问题解决方法}
  % PCF 即正构公式。
   \begin{columns}
     \begin{column}{0.6\textwidth}
       \includegraphics[width=\linewidth]{pcf-robo-planning.pdf}
     \end{column}
     \begin{column}{0.3\textwidth}
       \includegraphics[width=\linewidth]{pcf-room.png}
     \end{column}
   \end{columns}
   \begin{itemize}
   \item 机器人团队的目标是将积木运送到目标区域
   \item 每个积木可由两个或多个机器人拖动
   \item 世界的当前状态和小组的目标在 PCF 中形式化为
   \item 基于 PCF 的求证器和选择机制为团队生成最优的联合行动计划
   \item 只要 "世界 "的状态发生变化，就可以轻松修改当前计划
   \end{itemize}
 \end{frame}

 \begin{frame}
   \frametitle{A Master Degree Program. Semantic Technologies and Multiagent Systems}
   It is a joint effort of Saint-Petersburg Electrotechnical University (LETI), Irkutsk State University, and ISDCT SB RAS.
   Main subjects.

   \begin{itemize}
   \item Computation Geometry, Digital Signal Processing, Internet of Things,
   \item Semantic web, Semantic web Information System Development,
   \item AI Basics, Knowledge representation, Object-oriented Logic Programming,
   \item Answer Set Programming (SAT), Natural Language Processing,
   \item Machine Learning, Neural Networks, Deep Learning,
   \item Multiagent Systems, Optimization with Multiagent Systems.
   \end{itemize}

   Started at 2022-09-01.

   {\footnotesize \url{https://etu.ru/sveden/education/programs/semanticheskie-tehnologii-i-mnogoagentnye-sistemy-01.04.02.html}}
 \end{frame}

 \begin{frame}
   \frametitle{A Master Degree Program.  语义技术与多代理系统}
   该课程由圣彼得堡电工技术大学（LETI）、伊尔库茨克国立大学（Irkutsk State University）和俄罗斯科学院空间技术研究所（ISDCT SB RAS）联合开设。

   主要课题。

   \begin{itemize}
   \item 计算几何、数字信号处理、物联网、
   \item 语义网、语义网信息系统开发、
   \item 人工智能基础、知识表示、面向对象逻辑编程、
   \item 答案集编程 (SAT)、自然语言处理、
   \item 机器学习、神经网络、深度学习、
   \item 多代理系统，多代理系统优化。
   \end{itemize}

   始于 2022-09-01。

   {\footnotesize \url{https://etu.ru/sveden/education/programs/semanticheskie-tehnologii-i-mnogoagentnye-sistemy-01.04.02.html}}
 \end{frame}


 \begin{frame}
   \frametitle{Conclusion (the final one)}
   \begin{itemize}
   \item Classic knowledge-based systems are powerful AI tools for solving wide class of recognition problems and synthesis of various kind: source code, data objects, control
   \item Contemporary means combine classic and new approaches
   \item Less dependent on computational resources (as compared to machine learning)
   \item Allow justification of the produced solutions
   \item Cover a larger set of tasks
   \item Natural for math science, and require higher level of AI education
   \end{itemize}
 \end{frame}

 \begin{frame}
   \frametitle{结论（最后）}
   \begin{itemize}
   \item 经典的基于知识的系统是强大的人工智能工具，\\
     可用于解决广泛的识别问题和各种综合问题：\\
     源代码、数据对象、控制、数据处理、数据分析、数据挖掘。
   \item 当代手段结合了经典方法和新方法
   \item 较少依赖计算资源（与机器学习相比）
   \item 允许对所产生的解决方案进行论证
   \item 涵盖更多任务
   \item 自然适用于数学科学，需要更高水平的人工智能教育
   \end{itemize}
 \end{frame}

 % \begin{frame}
 %   \frametitle{Infrastructure for Scientific Research}
 %   The infrastructure is focused on creating service compositions that integrate software designed by developers from different subject areas to solve complex problems.

 %   \begin{columns}
 %     \begin{column}{0.4\textwidth}
 %       \includegraphics[width=\linewidth]{lego-pile.jpg}
 %     \end{column}
 %     \begin{column}{0.1\textwidth}
 %       \includegraphics[width=\linewidth]{arrow-right-svgrepo-com.pdf}
 %     \end{column}
 %     \begin{column}{0.4\textwidth}
 %       \includegraphics[width=\linewidth]{lego-mf.jpg}
 %     \end{column}
 %   \end{columns}
 % \end{frame}

 % \begin{frame}

 % \end{frame}









\begin{frame}
  \begin{center}
    \Large Thank You!

    \Large 谢谢大家!
\vfill
\includegraphics[width=0.4\linewidth]{presentation.png}
\url{https://github.com/eugeneai/talk-yantai-2023-12-18/blob/master/talk-la-in-soft-data-design-2023-12-18.pdf}
\end{center}
\end{frame}


\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
